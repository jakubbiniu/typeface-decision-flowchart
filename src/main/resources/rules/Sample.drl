package com.sample.rules

import com.sample.WindowState;
import com.sample.DroolsTest;
import java.util.*;

declare Question
	questionText: String
	answer: String
end

rule "Init"
	when
	then
		insert(new WindowState(""));
		System.out.println("init");
    	insert(new Question("What do you need a typeface for?",null));
end


rule "1-question"
	when
		$question: Question(questionText == "What do you need a typeface for?", answer == null);
		$windowState : WindowState(getAnswer() == "");
	then
		System.out.println("1-Question");
		$windowState.setText($question.getQuestionText());
    	$windowState.setButtonText1("Book");
    	$windowState.setButtonText2("Infographic");
    	$windowState.setButtonText3("Logo");
    	$windowState.setButtonText4("Newspaper");
    	update($windowState);
end

rule "1-answer"
when
	$question: Question(questionText == "What do you need a typeface for?", answer == null);
	$windowState : WindowState(getAnswer() != "");
then
	modify($question) {
        setAnswer($windowState.getAnswer())
    	}
    $windowState.setButtonText1("");
    $windowState.setButtonText2("");
    $windowState.setButtonText3("");
    $windowState.setButtonText4("");
    $windowState.setAnswer("");
    $windowState.setText("");
    update($windowState);
    update($question);
    System.out.println("1-answer");
end

rule "2-question"
	when
		$question: Question(questionText == "What do you need a typeface for?", answer == "Book");
		$windowState : WindowState(getAnswer() == "");
		not $question2 : Question(questionText == "Are you completely in doubt?", answer != null);
	then
		System.out.println("2-Question");
		insert(new Question("Are you completely in doubt?",null));
		$windowState.setText("Are you completely in doubt?");
    	$windowState.setButtonText1("Yes");
    	$windowState.setButtonText2("No");
    	update($windowState);
end

rule "2-answer"
when
	$question: Question(questionText == "Are you completely in doubt?", answer == null);
	$windowState : WindowState(getAnswer() != "");
then
	modify($question) {
        setAnswer($windowState.getAnswer())
    	}
    $windowState.setButtonText1("");
    $windowState.setButtonText2("");
    $windowState.setButtonText3("");
    $windowState.setButtonText4("");
    $windowState.setAnswer("");
    $windowState.setText("");
    update($windowState);
    update($question);
    System.out.println("2-answer");
end

rule "3-decision"
	when
		$question: Question(questionText == "Are you completely in doubt?", answer == "Yes");
		$windowState : WindowState(getAnswer() == "");
	then
		System.out.println("3-decision");
		$windowState.setText("Perfect typeface for you: Calson");
    	update($windowState);
end






